import e from "../../lib/State.js"; import t from "../enums/GameStateName.js"; import a from "../enums/ImageName.js"; import l from "../enums/SoundName.js"; import { CANVAS_WIDTH as o, CANVAS_HEIGHT as i, context as n, images as s, keys as r, sounds as d, stateMachine as m, timer as p } from "../globals.js"; import h from "../services/SaveManager.js"; export default class c extends e { constructor() { super(), this.newGameOptionSelected = !0 } async enter() { d.play(l.LeFestin), this.loadedData = await h.loadGame() } loadLevelsOntoStates() { for (let e = 0; e < this.loadedData.entities.length; e++)this.loadedData.entities[e].setLevelOnStates(this.loadedData); h.loadData = this.loadedData } exit() { } update(e) { p.update(e), r.Enter ? (r.Enter = !1, d.play(l.Confirm), this.newGameOptionSelected ? m.change(t.Transition, { fromState: this, toState: m.states[t.Exposition], toStateEnterParameters: { newGameOptionSelected: this.newGameOptionSelected } }) : m.change(t.Transition, { fromState: this, toState: m.states[t.Play], toStateEnterParameters: { newGameOptionSelected: this.newGameOptionSelected } })) : r.ArrowLeft ? (r.ArrowLeft = !1, d.play(l.SelectionChanged), this.newGameOptionSelected ? this.loadedData.entities.length > 0 && (this.newGameOptionSelected = !0) : this.newGameOptionSelected = !0) : r.ArrowRight ? (r.ArrowRight = !1, d.play(l.SelectionChanged), this.newGameOptionSelected ? this.loadedData.entities.length > 0 && (this.newGameOptionSelected = !1) : this.newGameOptionSelected = !0) : (r.C || r.c) && (r.C = !1, r.c = !1, m.change(t.Transition, { fromState: this, toState: m.states[t.Credits] })) } render() { n.save(), s.render(a.Background, 0, 0, o, i), n.fillStyle = "rgba(10,10,10,1)", n.fillRect(0, 0, 5, i), n.fillRect(0, 0, o, 5), n.fillRect(o - 5, 0, o, i), n.fillRect(0, i - 5, o, i), n.fillStyle = "rgba(10,10,10,0.9)", n.fillRect(0, 100, o, 90), n.textBaseline = "middle", n.textAlign = "center", n.font = "50px Copperplate", n.fillStyle = "gold", n.shadowBlur = 25, n.shadowColor = "goldenrod", n.fillText("Proletari", o / 2 - 45, i / 2 - 40), n.font = "80px Anarchaos", n.fillStyle = "crimson", n.shadowColor = "black", n.fillText("Rat", o / 2 + 135, i / 2 - 30); let e = "purple", t = "purple"; this.newGameOptionSelected ? e = "magenta" : t = "magenta", n.font = "bold 30px Dribble", n.shadowColor = e, n.fillStyle = e, n.fillText("new game", o / 2 - 50, i - 80), n.fillStyle = t, n.shadowColor = t, n.fillText("continue", o / 2 + 50, i - 80), n.font = "12px Copperplate", n.fillStyle = "black", n.shadowBlur = 5, n.shadowColor = "magenta", n.fillText("Credits [C]", o - 50, i - 20), n.restore() } };